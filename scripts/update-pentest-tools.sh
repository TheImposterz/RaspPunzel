#!/bin/bash
# =================================================================================================
# RaspPunzel - Update Pentest WiFi Tools Script
# =================================================================================================

set -e

RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
NC='\033[0m'

TOOLS_DIR="/usr/share"

echo -e "${BLUE}═══════════════════════════════════════════════════════════════${NC}"
echo -e "${BLUE}        RaspPunzel - Update Pentest Tools${NC}"
echo -e "${BLUE}═══════════════════════════════════════════════════════════════${NC}"
echo ""

log_info() {
    echo -e "${YELLOW}[~] $1${NC}"
}

log_success() {
    echo -e "${GREEN}[+] $1${NC}"
}

log_error() {
    echo -e "${RED}[!] $1${NC}"
}

update_tool() {
    local tool_name=$1
    local tool_path="${TOOLS_DIR}/${tool_name}"
    
    if [[ ! -d "$tool_path" ]]; then
        log_error "$tool_name not found at $tool_path"
        return 1
    fi
    
    log_info "Updating $tool_name..."
    cd "$tool_path"
    
    if git pull --quiet 2>/dev/null; then
        log_success "$tool_name updated"
    else
        log_error "$tool_name update failed"
    fi
}

# Update system packages
log_info "Updating system packages..."
apt-get update -qq
apt-get upgrade -y -qq wifite reaver bully mdk4 kismet hcxdumptool hcxtools 2>/dev/null || true
echo ""

# Update Git-based tools
TOOLS=(
    "wifipumpkin3"
    "wifiphisher"
    "fluxion"
    "eaphammer"
    "airgeddon"
    "creap"
    "berate_ap"
    "wpa_sycophant"
    "Scapy-com"
)

for tool in "${TOOLS[@]}"; do
    update_tool "$tool"
done

echo ""
log_success "All tools updated"
echo ""