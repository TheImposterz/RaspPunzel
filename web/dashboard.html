<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RaspPunzel - Dashboard</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.2/socket.io.js"></script>
    <style>body {
    font-family: 'Courier New', 'Consolas', monospace;
    background: #0a0e27;
    background-image: 
        linear-gradient(rgba(0, 255, 65, 0.03) 1px, transparent 1px),
        linear-gradient(90deg, rgba(0, 255, 65, 0.03) 1px, transparent 1px);
    background-size: 50px 50px;
    color: #00ff41;
}

.header {
    background: rgba(15, 20, 40, 0.95);
    box-shadow: 0 2px 10px rgba(0, 255, 65, 0.3);
    border-bottom: 2px solid #00ff41;
    position: sticky;
    top: 0;
    z-index: 100;
    backdrop-filter: blur(10px);
}

.header-top {
    padding: 0 24px;
    border-bottom: 1px solid rgba(0, 255, 65, 0.2);
}

.header-content {
    max-width: 1400px;
    margin: 0 auto;
    display: flex;
    justify-content: space-between;
    align-items: center;
    height: 64px;
}

.header-left h1 {
    font-size: 20px;
    font-weight: 700;
    color: #00ff41;
    text-shadow: 0 0 10px rgba(0, 255, 65, 0.5);
    letter-spacing: 2px;
}

.user-menu { position: relative; }

.user-button {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 8px 12px;
    background: rgba(0, 0, 0, 0.3);
    border: 1px solid #00ff41;
    border-radius: 2px;
    cursor: pointer;
    transition: all 0.2s;
}

.user-button:hover {
    background: rgba(0, 255, 65, 0.1);
    box-shadow: 0 0 10px rgba(0, 255, 65, 0.3);
}

.user-avatar {
    width: 32px;
    height: 32px;
    border-radius: 2px;
    background: #00ff41;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #0a0e27;
    font-weight: 700;
    font-size: 14px;
    box-shadow: 0 0 10px rgba(0, 255, 65, 0.5);
}

.dropdown-menu {
    position: absolute;
    right: 0;
    top: calc(100% + 8px);
    background: rgba(15, 20, 40, 0.98);
    border: 1px solid #00ff41;
    border-radius: 2px;
    box-shadow: 0 4px 20px rgba(0, 255, 65, 0.3);
    min-width: 200px;
    display: none;
}

.dropdown-menu.show { display: block; }

.dropdown-item {
    display: block;
    padding: 12px 16px;
    color: #00ff41;
    cursor: pointer;
    font-size: 13px;
    transition: all 0.2s;
    border-bottom: 1px solid rgba(0, 255, 65, 0.1);
}

.dropdown-item:last-child { border-bottom: none; }

.dropdown-item:hover {
    background: rgba(0, 255, 65, 0.1);
    padding-left: 20px;
}

.dropdown-item.danger {
    color: #ff4444;
}

.dropdown-item.danger:hover {
    background: rgba(255, 0, 0, 0.1);
}

.nav-tabs {
    max-width: 1400px;
    margin: 0 auto;
    display: flex;
    gap: 4px;
    padding: 0 24px;
}

.nav-tab {
    padding: 16px 24px;
    background: none;
    border: none;
    border-bottom: 3px solid transparent;
    color: rgba(0, 255, 65, 0.5);
    font-size: 12px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
    display: flex;
    align-items: center;
    gap: 8px;
    text-transform: uppercase;
    letter-spacing: 1px;
    font-family: 'Courier New', monospace;
}

.nav-tab:hover {
    color: #00ff41;
    background: rgba(0, 255, 65, 0.05);
}

.nav-tab.active {
    color: #00ff41;
    border-bottom-color: #00ff41;
    text-shadow: 0 0 10px rgba(0, 255, 65, 0.5);
}

.container {
    max-width: 1400px;
    margin: 0 auto;
    padding: 24px;
}

.tab-content {
    display: none;
}

.tab-content.active {
    display: block;
    animation: fadeIn 0.3s;
}

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
}

.stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 20px;
    margin-bottom: 24px;
}

.stat-card {
    background: rgba(15, 20, 40, 0.8);
    border: 1px solid rgba(0, 255, 65, 0.3);
    border-radius: 2px;
    padding: 20px;
    box-shadow: 0 0 20px rgba(0, 255, 65, 0.1);
    transition: all 0.2s;
}

.stat-card:hover {
    border-color: #00ff41;
    box-shadow: 0 0 30px rgba(0, 255, 65, 0.2);
    transform: translateY(-2px);
}

.stat-label {
    font-size: 11px;
    color: rgba(0, 255, 65, 0.7);
    margin-bottom: 8px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 1px;
}

.stat-value {
    font-size: 28px;
    font-weight: 700;
    color: #00ff41;
    text-shadow: 0 0 10px rgba(0, 255, 65, 0.5);
}

.stat-value.online {
    color: #00ff41;
    animation: pulse 2s ease-in-out infinite;
}

.stat-value.offline { color: #ff4444; }
.stat-value.warning { color: #ffdd57; }

.main-grid {
    display: grid;
    grid-template-columns: 2fr 1fr;
    gap: 24px;
    margin-bottom: 24px;
}

.panel {
    background: rgba(15, 20, 40, 0.8);
    border: 1px solid rgba(0, 255, 65, 0.3);
    border-radius: 2px;
    box-shadow: 0 0 20px rgba(0, 255, 65, 0.1);
    overflow: hidden;
}

.panel-header {
    padding: 16px 20px;
    border-bottom: 1px solid rgba(0, 255, 65, 0.3);
    font-weight: 700;
    font-size: 13px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    background: rgba(0, 0, 0, 0.3);
    color: #00ff41;
    text-transform: uppercase;
    letter-spacing: 1px;
}

.panel-body { padding: 20px; }

.btn-group {
    display: flex;
    flex-wrap: wrap;
    gap: 12px;
}

.btn {
    padding: 10px 20px;
    border-radius: 2px;
    border: 1px solid;
    font-size: 12px;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.2s;
    text-transform: uppercase;
    letter-spacing: 1px;
    font-family: 'Courier New', monospace;
}

.btn-primary {
    background: rgba(0, 0, 0, 0.5);
    color: #00ff41;
    border-color: #00ff41;
}

.btn-primary:hover {
    background: rgba(0, 255, 65, 0.1);
    box-shadow: 0 0 15px rgba(0, 255, 65, 0.5);
    transform: translateY(-2px);
}

.btn-secondary {
    background: rgba(0, 0, 0, 0.3);
    color: rgba(0, 255, 65, 0.7);
    border-color: rgba(0, 255, 65, 0.5);
}

.btn-secondary:hover {
    background: rgba(0, 255, 65, 0.05);
    color: #00ff41;
    border-color: #00ff41;
}

.btn-success {
    background: rgba(0, 255, 65, 0.1);
    color: #00ff41;
    border-color: #00ff41;
}

.btn-success:hover {
    background: rgba(0, 255, 65, 0.2);
    box-shadow: 0 0 15px rgba(0, 255, 65, 0.3);
}

.btn-danger {
    background: rgba(255, 0, 0, 0.1);
    color: #ff4444;
    border-color: #ff4444;
}

.btn-danger:hover {
    background: rgba(255, 0, 0, 0.2);
    box-shadow: 0 0 15px rgba(255, 0, 0, 0.3);
}

.btn-warning {
    background: rgba(255, 193, 7, 0.1);
    color: #ffdd57;
    border-color: #ffdd57;
}

.btn-warning:hover {
    background: rgba(255, 193, 7, 0.2);
    box-shadow: 0 0 15px rgba(255, 193, 7, 0.3);
}

.list-empty {
    text-align: center;
    padding: 40px 20px;
    color: rgba(0, 255, 65, 0.3);
    font-size: 12px;
    text-transform: uppercase;
    letter-spacing: 1px;
}

.list-item {
    padding: 16px;
    border-bottom: 1px solid rgba(0, 255, 65, 0.1);
    transition: all 0.2s;
}

.list-item:hover {
    background: rgba(0, 255, 65, 0.05);
    border-left: 3px solid #00ff41;
    padding-left: 21px;
}

.list-item:last-child { border-bottom: none; }

.list-item-title {
    font-weight: 700;
    color: #00ff41;
    margin-bottom: 8px;
    font-size: 14px;
}

.list-item-meta {
    font-size: 11px;
    color: rgba(0, 255, 65, 0.6);
}

.badge {
    display: inline-block;
    padding: 4px 8px;
    border-radius: 2px;
    font-size: 10px;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 1px;
    border: 1px solid;
}

.badge-info {
    background: rgba(0, 255, 255, 0.1);
    color: #00ffff;
    border-color: #00ffff;
}

.badge-success {
    background: rgba(0, 255, 65, 0.1);
    color: #00ff41;
    border-color: #00ff41;
}

.badge-danger {
    background: rgba(255, 0, 0, 0.1);
    color: #ff4444;
    border-color: #ff4444;
}

.badge-warning {
    background: rgba(255, 193, 7, 0.1);
    color: #ffdd57;
    border-color: #ffdd57;
}

.terminal {
    background: rgba(0, 0, 0, 0.8);
    border: 1px solid #00ff41;
    border-radius: 2px;
    box-shadow: 0 0 30px rgba(0, 255, 65, 0.2);
    overflow: hidden;
}

.terminal-header {
    background: rgba(0, 0, 0, 0.5);
    padding: 12px 16px;
    display: flex;
    justify-content: space-between;
    color: #00ff41;
    font-size: 11px;
    font-weight: 700;
    border-bottom: 1px solid rgba(0, 255, 65, 0.3);
    text-transform: uppercase;
    letter-spacing: 2px;
}

.terminal-body {
    padding: 16px;
    height: 300px;
    overflow-y: auto;
    font-family: 'Courier New', monospace;
    font-size: 12px;
    line-height: 1.6;
    background: rgba(0, 0, 0, 0.9);
}

.terminal-line {
    margin-bottom: 4px;
    color: #00ff41;
    opacity: 0.8;
}

.terminal-line.success {
    color: #00ff41;
    opacity: 1;
    font-weight: 700;
}

.terminal-line.error {
    color: #ff4444;
    opacity: 1;
}

.terminal-line.warning {
    color: #ffdd57;
    opacity: 1;
}

.terminal-line.info {
    color: #00ffff;
    opacity: 0.9;
}

.terminal-time {
    color: rgba(0, 255, 65, 0.4);
    margin-right: 8px;
}

.toast {
    position: fixed;
    top: 80px;
    right: 24px;
    background: rgba(15, 20, 40, 0.95);
    border: 1px solid #00ff41;
    border-radius: 2px;
    box-shadow: 0 0 20px rgba(0, 255, 65, 0.5);
    padding: 16px 20px;
    display: flex;
    align-items: center;
    gap: 12px;
    min-width: 300px;
    transform: translateX(400px);
    transition: transform 0.3s ease;
    z-index: 1000;
    backdrop-filter: blur(10px);
}

.toast.show { transform: translateX(0); }

.toast-icon {
    width: 20px;
    height: 20px;
    border-radius: 2px;
    flex-shrink: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 700;
}

.toast.success {
    border-color: #00ff41;
}

.toast.success .toast-icon {
    background: #00ff41;
    color: #0a0e27;
}

.toast.error {
    border-color: #ff4444;
}

.toast.error .toast-icon {
    background: #ff4444;
    color: #0a0e27;
}

.toast-message {
    flex: 1;
    font-size: 12px;
    color: #00ff41;
    font-family: 'Courier New', monospace;
}

.info-grid {
    display: grid;
    gap: 12px;
    font-size: 12px;
}

.info-row {
    display: flex;
    justify-content: space-between;
    padding: 8px 0;
    border-bottom: 1px solid rgba(0, 255, 65, 0.1);
}

.info-row:last-child { border-bottom: none; }

.info-label {
    color: rgba(0, 255, 65, 0.6);
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 1px;
    font-size: 10px;
}

.info-value {
    color: #00ff41;
    font-weight: 700;
}

.quick-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 12px;
}

.adapter-card {
    background: rgba(0, 0, 0, 0.3);
    border: 1px solid rgba(0, 255, 65, 0.3);
    border-radius: 2px;
    padding: 16px;
    transition: all 0.2s;
}

.adapter-card:hover {
    border-color: #00ff41;
    box-shadow: 0 0 20px rgba(0, 255, 65, 0.2);
    transform: translateY(-2px);
}

.adapter-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 12px;
}

.adapter-name {
    font-weight: 700;
    font-size: 14px;
    color: #00ff41;
}

.adapter-info {
    font-size: 11px;
    color: rgba(0, 255, 65, 0.6);
    margin-bottom: 4px;
}

/* Scrollbar personnalis√© */
::-webkit-scrollbar {
    width: 10px;
    height: 10px;
}

::-webkit-scrollbar-track {
    background: rgba(0, 0, 0, 0.5);
    border: 1px solid rgba(0, 255, 65, 0.2);
}

::-webkit-scrollbar-thumb {
    background: rgba(0, 255, 65, 0.3);
    border-radius: 2px;
}

::-webkit-scrollbar-thumb:hover {
    background: rgba(0, 255, 65, 0.5);
}

/* Effet de scan CRT */
@keyframes scan {
    0% { transform: translateY(-100%); }
    100% { transform: translateY(100%); }
}

body::after {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(
        to bottom,
        transparent 50%,
        rgba(0, 255, 65, 0.02) 50%
    );
    background-size: 100% 4px;
    pointer-events: none;
    animation: scan 8s linear infinite;
    z-index: 9999;
}

/* Animation de clignotement pour les √©l√©ments actifs */
@keyframes blink {
    0%, 50%, 100% { opacity: 1; }
    25%, 75% { opacity: 0.5; }
}

/* Animation de glitch pour les titres */
@keyframes glitch {
    0%, 100% { transform: translate(0); }
    20% { transform: translate(-2px, 2px); }
    40% { transform: translate(-2px, -2px); }
    60% { transform: translate(2px, 2px); }
    80% { transform: translate(2px, -2px); }
}

.logo h1:hover {
    animation: glitch 0.3s ease;
}

/* Effet de typing pour les chargements */
@keyframes typing {
    from { width: 0; }
    to { width: 100%; }
}

.loading-spinner::after {
    content: '...';
    animation: typing 1s steps(3) infinite;
}

/* Media queries pour responsive */
@media (max-width: 1024px) {
    .main-grid { grid-template-columns: 1fr; }
}

@media (max-width: 768px) {
    .stats-grid { grid-template-columns: repeat(2, 1fr); }
    .quick-grid { grid-template-columns: 1fr; }
    .nav-tabs {
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
    }
}

@media (max-width: 480px) {
    .login-container {
        padding: 30px 20px;
    }
    
    .header-left h1 {
        font-size: 16px;
    }
    
    .nav-tab {
        padding: 12px 16px;
        font-size: 11px;
    }
}

/* Animations suppl√©mentaires pour le th√®me hacker */
.stat-card::before {
    content: '';
    position: absolute;
    top: -2px;
    left: -2px;
    right: -2px;
    bottom: -2px;
    background: linear-gradient(45deg, #00ff41, transparent);
    opacity: 0;
    transition: opacity 0.3s;
    pointer-events: none;
    z-index: -1;
    border-radius: 2px;
}

.stat-card {
    position: relative;
}

.stat-card:hover::before {
    opacity: 0.3;
}

/* Effet de glow pour les boutons actifs */
.btn:active {
    box-shadow: 0 0 30px rgba(0, 255, 65, 0.7);
}

/* Animation pour les nouveaux √©l√©ments de terminal */
.terminal-line:last-child {
    animation: fadeInTerminal 0.3s ease;
}

@keyframes fadeInTerminal {
    from {
        opacity: 0;
        transform: translateX(-10px);
    }
    to {
        opacity: 1;
        transform: translateX(0);
    }
}

/* Effet de matrice en arri√®re-plan (optionnel) */
@keyframes matrix {
    0% { transform: translateY(-100%); }
    100% { transform: translateY(100%); }
}

/* S√©lection de texte personnalis√©e */
::selection {
    background: rgba(0, 255, 65, 0.3);
    color: #00ff41;
}

::-moz-selection {
    background: rgba(0, 255, 65, 0.3);
    color: #00ff41;
}

/* Focus visible pour l'accessibilit√© */
*:focus-visible {
    outline: 2px solid #00ff41;
    outline-offset: 2px;
}

/* Am√©lioration des transitions */
* {
    transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
}

/* Effet de hover sur les cartes */
.panel:hover {
    box-shadow: 0 0 30px rgba(0, 255, 65, 0.15);
    border-color: #00ff41;
}

/* Indicateur de chargement personnalis√© */
.loading-spinner {
    position: relative;
}

.loading-spinner::before {
    content: '>';
    margin-right: 5px;
    animation: blink 1s infinite;
}

/* Style pour les inputs en mode autocomplete */
input:-webkit-autofill,
input:-webkit-autofill:hover,
input:-webkit-autofill:focus {
    -webkit-text-fill-color: #00ff41;
    -webkit-box-shadow: 0 0 0px 1000px rgba(0, 0, 0, 0.7) inset;
    box-shadow: 0 0 0px 1000px rgba(0, 0, 0, 0.7) inset;
    border: 1px solid #00ff41;
}

/* Animation pour le menu d√©roulant */
.dropdown-menu {
    animation: slideDown 0.2s ease;
}

@keyframes slideDown {
    from {
        opacity: 0;
        transform: translateY(-10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* Effet de typing pour le footer */
.footer p {
    overflow: hidden;
    white-space: nowrap;
    animation: typing 2s steps(30) 1s 1 normal both;
}

/* Am√©lioration du contrast pour l'accessibilit√© */
@media (prefers-contrast: high) {
    .stat-value,
    .logo h1,
    .terminal-line {
        text-shadow: none;
    }
    
    .btn {
        border-width: 2px;
    }
}

/* R√©duction des animations si pr√©f√©rence utilisateur */
@media (prefers-reduced-motion: reduce) {
    *,
    *::before,
    *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
    }
    
    body::after {
        animation: none;
    }
}

/* Print styles (optionnel) */
@media print {
    body::before,
    body::after,
    .terminal {
        display: none;
    }
    
    body {
        background: white;
        color: black;
    }
}</style>
</head>
<body>
    <div class="header">
        <div class="header-top">
            <div class="header-content">
                <div class="header-left">
                    <h1>üçì RaspPunzel</h1>
                </div>
                <div class="header-right">
                    <div class="user-menu">
                        <div class="user-button" onclick="toggleUserMenu()">
                            <div class="user-avatar">A</div>
                            <span>Admin</span>
                            <span>‚ñº</span>
                        </div>
                        <div class="dropdown-menu" id="userDropdown">
                            <div class="dropdown-item" onclick="reloadPage()">üîÑ Actualiser</div>
                            <div class="dropdown-item danger" onclick="logout()">üö™ D√©connexion</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="nav-tabs">
            <button class="nav-tab active" onclick="switchTab('ligolo')">
                <span>üîó</span> Ligolo-ng
            </button>
            <button class="nav-tab" onclick="switchTab('wifi-ap')">
                <span>üì°</span> WiFi Access Point
            </button>
            <button class="nav-tab" onclick="switchTab('pentest')">
                <span>üéØ</span> Pentest Adapters
            </button>
        </div>
    </div>

    <div class="container">
        <!-- TAB LIGOLO -->
        <div id="tab-ligolo" class="tab-content active">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-label">Agent Ligolo</div>
                    <div class="stat-value" id="agentStatus">--</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Connexion Proxy</div>
                    <div class="stat-value" id="proxyConnection">--</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Routes Actives</div>
                    <div class="stat-value" id="routesCount">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Uptime</div>
                    <div class="stat-value" id="uptime">--</div>
                </div>
            </div>

            <div class="main-grid">
                <div>
                    <div class="panel" style="margin-bottom: 24px;">
                        <div class="panel-header">Contr√¥le Ligolo-ng</div>
                        <div class="panel-body">
                            <div class="btn-group">
                                <button class="btn btn-success" onclick="startLigolo()">‚ñ∂Ô∏è D√©marrer</button>
                                <button class="btn btn-secondary" onclick="restartLigolo()">üîÑ Red√©marrer</button>
                                <button class="btn btn-danger" onclick="stopLigolo()">‚èπÔ∏è Arr√™ter</button>
                            </div>
                        </div>
                    </div>

                    <div class="panel">
                        <div class="panel-header">
                            <span>Routes r√©seau</span>
                            <button class="btn btn-secondary" onclick="refreshRoutes()" style="padding: 6px 12px; font-size: 12px;">üîÑ</button>
                        </div>
                        <div id="routesList">
                            <div class="list-empty">Chargement des routes...</div>
                        </div>
                    </div>
                </div>

                <div>
                    <div class="panel" style="margin-bottom: 24px;">
                        <div class="panel-header">Actions rapides</div>
                        <div class="panel-body">
                            <div class="quick-grid">
                                <button class="btn btn-secondary" onclick="showLogs()">üìã Logs</button>
                                <button class="btn btn-secondary" onclick="showNetworkInfo()">üåê R√©seau</button>
                                <button class="btn btn-secondary" onclick="exportConfig()">üíæ Export</button>
                                <button class="btn btn-secondary" onclick="refreshRoutes()">üîÑ Routes</button>
                            </div>
                        </div>
                    </div>

                    <div class="panel">
                        <div class="panel-header">Configuration Ligolo</div>
                        <div class="panel-body">
                            <div class="info-grid">
                                <div class="info-row">
                                    <span class="info-label">Proxy Host</span>
                                    <span class="info-value" id="proxyHost">--</span>
                                </div>
                                <div class="info-row">
                                    <span class="info-label">Proxy Port</span>
                                    <span class="info-value" id="proxyPort">--</span>
                                </div>
                                <div class="info-row">
                                    <span class="info-label">Version</span>
                                    <span class="info-value" id="ligoloVersion">--</span>
                                </div>
                                <div class="info-row">
                                    <span class="info-label">PID</span>
                                    <span class="info-value" id="ligoloPid">--</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- TAB WIFI AP -->
        <div id="tab-wifi-ap" class="tab-content">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-label">Hostapd</div>
                    <div class="stat-value" id="hostapdStatus">--</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">DNSMasq</div>
                    <div class="stat-value" id="dnsmasqStatus">--</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Clients Connect√©s</div>
                    <div class="stat-value" id="clientsCount">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Interface AP</div>
                    <div class="stat-value" id="apInterface" style="font-size: 18px;">--</div>
                </div>
            </div>

            <div class="main-grid">
                <div>
                    <div class="panel" style="margin-bottom: 24px;">
                        <div class="panel-header">Contr√¥le Access Point</div>
                        <div class="panel-body">
                            <div class="btn-group">
                                <button class="btn btn-success" onclick="startAP()">‚ñ∂Ô∏è D√©marrer AP</button>
                                <button class="btn btn-secondary" onclick="restartAP()">üîÑ Red√©marrer</button>
                                <button class="btn btn-danger" onclick="stopAP()">‚èπÔ∏è Arr√™ter AP</button>
                            </div>
                        </div>
                    </div>

                    <div class="panel">
                        <div class="panel-header">Clients connect√©s</div>
                        <div id="clientsList">
                            <div class="list-empty">Aucun client connect√©</div>
                        </div>
                    </div>
                </div>

                <div>
                    <div class="panel">
                        <div class="panel-header">Configuration AP</div>
                        <div class="panel-body">
                            <div class="info-grid">
                                <div class="info-row">
                                    <span class="info-label">SSID</span>
                                    <span class="info-value">PWNBOX_ADMIN</span>
                                </div>
                                <div class="info-row">
                                    <span class="info-label">IP Gateway</span>
                                    <span class="info-value">10.0.0.1</span>
                                </div>
                                <div class="info-row">
                                    <span class="info-label">DHCP Range</span>
                                    <span class="info-value">10.0.0.2-30</span>
                                </div>
                                <div class="info-row">
                                    <span class="info-label">Canal</span>
                                    <span class="info-value">11</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- TAB PENTEST -->
        <div id="tab-pentest" class="tab-content">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-label">Adapters D√©tect√©s</div>
                    <div class="stat-value" id="adaptersCount">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Mode Monitor</div>
                    <div class="stat-value" id="monitorModeCount">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">CPU</div>
                    <div class="stat-value" id="cpuUsage">--%</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">M√©moire</div>
                    <div class="stat-value" id="memoryUsage">--%</div>
                </div>
            </div>

            <div class="main-grid">
                <div>
                    <div class="panel">
                        <div class="panel-header">
                            <span>Adapters WiFi</span>
                            <button class="btn btn-secondary" onclick="refreshAdapters()" style="padding: 6px 12px; font-size: 12px;">üîÑ</button>
                        </div>
                        <div class="panel-body">
                            <div id="adaptersList">
                                <div class="list-empty">Chargement des adapters...</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div>
                    <div class="panel" style="margin-bottom: 24px;">
                        <div class="panel-header">Actions rapides</div>
                        <div class="panel-body">
                            <div class="quick-grid">
                                <button class="btn btn-secondary" onclick="showLogs()">üìã Logs</button>
                                <button class="btn btn-secondary" onclick="showNetworkInfo()">üåê R√©seau</button>
                                <button class="btn btn-secondary" onclick="exportConfig()">üíæ Export</button>
                                <button class="btn btn-warning" onclick="scanNetworks()">üì° Scan</button>
                            </div>
                        </div>
                    </div>

                    <div class="panel">
                        <div class="panel-header">Informations syst√®me</div>
                        <div class="panel-body">
                            <div class="info-grid">
                                <div class="info-row">
                                    <span class="info-label">Hostname</span>
                                    <span class="info-value" id="hostname">--</span>
                                </div>
                                <div class="info-row">
                                    <span class="info-label">Adresse IP</span>
                                    <span class="info-value" id="ipAddress">--</span>
                                </div>
                                <div class="info-row">
                                    <span class="info-label">Kernel</span>
                                    <span class="info-value" id="kernelVersion">--</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- TERMINAL (commun √† tous les onglets) -->
        <div class="terminal">
            <div class="terminal-header">
                <span>Terminal</span>
                <button class="btn btn-secondary" onclick="clearTerminal()" style="padding: 4px 12px; font-size: 12px;">Effacer</button>
            </div>
            <div class="terminal-body" id="terminal">
                <div class="terminal-line info">RaspPunzel Dashboard v2.1 - Multi-sections</div>
                <div class="terminal-line">Connexion au serveur...</div>
            </div>
        </div>
    </div>

    <div class="toast" id="toast">
        <div class="toast-icon">‚úì</div>
        <div class="toast-message" id="toastMessage"></div>
    </div>

    <script>
        const API_BASE = window.location.origin;
        let socket;
        let currentTab = 'ligolo';

        // Navigation entre onglets
        function switchTab(tabName) {
            currentTab = tabName;
            
            // Masquer tous les onglets
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // D√©sactiver tous les boutons
            document.querySelectorAll('.nav-tab').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Activer l'onglet s√©lectionn√©
            document.getElementById(`tab-${tabName}`).classList.add('active');
            event.target.closest('.nav-tab').classList.add('active');
            
            addToTerminal(`Navigation vers: ${tabName}`, 'info');
            
            // Charger les donn√©es sp√©cifiques √† l'onglet
            loadTabData(tabName);
        }

        function toggleUserMenu() {
            document.getElementById('userDropdown').classList.toggle('show');
        }

        document.addEventListener('click', (e) => {
            if (!e.target.closest('.user-menu')) {
                document.getElementById('userDropdown').classList.remove('show');
            }
        });

        function logout() {
            window.location.href = '/logout';
        }

        function reloadPage() {
            window.location.reload();
        }

        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            const toastMessage = document.getElementById('toastMessage');
            toast.className = `toast ${type}`;
            toastMessage.textContent = message;
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 3000);
        }

        function addToTerminal(text, type = '') {
            const terminal = document.getElementById('terminal');
            const line = document.createElement('div');
            line.className = `terminal-line ${type}`;
            const time = new Date().toLocaleTimeString();
            line.innerHTML = `<span class="terminal-time">${time}</span>${text}`;
            terminal.appendChild(line);
            terminal.scrollTop = terminal.scrollHeight;
            while (terminal.children.length > 100) {
                terminal.removeChild(terminal.firstChild);
            }
        }

        function clearTerminal() {
            document.getElementById('terminal').innerHTML = '<div class="terminal-line info">Terminal effac√©</div>';
        }

        function initializeSocket() {
            socket = io(API_BASE);
            socket.on('connect', () => {
                addToTerminal('‚úì WebSocket connect√©', 'success');
                loadSystemStatus();
            });
            socket.on('disconnect', () => {
                addToTerminal('‚úó WebSocket d√©connect√©', 'warning');
            });
            socket.on('terminal_output', (data) => {
                addToTerminal(data.output, 'info');
            });
        }

        async function loadSystemStatus() {
            try {
                const response = await fetch(`${API_BASE}/api/status`);
                const data = await response.json();
                
                if (data.success) {
                    // Stats communes
                    document.getElementById('cpuUsage').textContent = `${Math.round(data.system.cpu_percent)}%`;
                    document.getElementById('memoryUsage').textContent = `${Math.round(data.system.memory_percent)}%`;
                    document.getElementById('uptime').textContent = data.system.uptime || '--';
                    document.getElementById('hostname').textContent = data.system.hostname || '--';
                    
                    // Ligolo
                    const agentStatus = document.getElementById('agentStatus');
                    if (data.services && data.services['ligolo-agent']) {
                        agentStatus.textContent = 'ACTIF';
                        agentStatus.classList.add('online');
                        agentStatus.classList.remove('offline');
                    } else {
                        agentStatus.textContent = 'INACTIF';
                        agentStatus.classList.add('offline');
                        agentStatus.classList.remove('online');
                    }
                    
                    // WiFi AP
                    updateAPStatus(data.services);
                    
                    // Connexion proxy
                    if (data.ligolo && data.ligolo.connection && data.ligolo.connection.connected) {
                        document.getElementById('proxyConnection').textContent = 'CONNECT√â';
                        document.getElementById('proxyConnection').classList.add('online');
                    } else {
                        document.getElementById('proxyConnection').textContent = 'D√âCONNECT√â';
                        document.getElementById('proxyConnection').classList.add('offline');
                    }
                    
                    if (data.ligolo) {
                        document.getElementById('proxyHost').textContent = data.ligolo.proxy_host || 'Non configur√©';
                        document.getElementById('proxyPort').textContent = data.ligolo.proxy_port || '--';
                        document.getElementById('ligoloVersion').textContent = data.ligolo.version || '--';
                        document.getElementById('ligoloPid').textContent = data.ligolo.pid || '--';
                    }
                    
                    if (data.system.network_interfaces) {
                        const interfaces = Object.values(data.system.network_interfaces);
                        const firstInterface = interfaces.find(i => i.ip && i.ip !== '127.0.0.1');
                        document.getElementById('ipAddress').textContent = firstInterface?.ip || '--';
                    }
                    
                    // Routes
                    document.getElementById('routesCount').textContent = data.routes_count || 0;
                    updateRoutes(data.routes);
                    
                    // Adapters
                    loadAdapters();
                }
            } catch (error) {
                addToTerminal(`Erreur: ${error.message}`, 'error');
            }
        }

        function updateAPStatus(services) {
            const hostapdStatus = document.getElementById('hostapdStatus');
            const dnsmasqStatus = document.getElementById('dnsmasqStatus');
            
            if (services && services.hostapd) {
                hostapdStatus.textContent = 'ACTIF';
                hostapdStatus.classList.add('online');
                hostapdStatus.classList.remove('offline');
            } else {
                hostapdStatus.textContent = 'INACTIF';
                hostapdStatus.classList.add('offline');
                hostapdStatus.classList.remove('online');
            }
            
            if (services && services.dnsmasq) {
                dnsmasqStatus.textContent = 'ACTIF';
                dnsmasqStatus.classList.add('online');
                dnsmasqStatus.classList.remove('offline');
            } else {
                dnsmasqStatus.textContent = 'INACTIF';
                dnsmasqStatus.classList.add('offline');
                dnsmasqStatus.classList.remove('online');
            }
        }

        function loadTabData(tabName) {
            switch(tabName) {
                case 'ligolo':
                    refreshRoutes();
                    break;
                case 'wifi-ap':
                    loadAPClients();
                    break;
                case 'pentest':
                    loadAdapters();
                    break;
            }
        }

        function updateRoutes(routes) {
            const routesList = document.getElementById('routesList');
            
            if (!routes || !Array.isArray(routes) || routes.length === 0) {
                routesList.innerHTML = '<div class="list-empty">Aucune route configur√©e<br><small style="margin-top: 8px; display: block;">V√©rifiez que l\'agent Ligolo est actif et connect√©</small></div>';
                return;
            }
            
            routesList.innerHTML = routes.map((route, index) => {
                const destination = route.destination || route.network || route.subnet || 'N/A';
                const interfaceName = route.interface || route.dev || route.iface || 'N/A';
                const gateway = route.gateway || route.via || route.gw || 'N/A';
                const type = route.type || 'unknown';
                
                let badgeClass = 'badge-info';
                if (type === 'ligolo') badgeClass = 'badge-success';
                else if (type === 'default') badgeClass = 'badge-warning';
                
                return `
                    <div class="list-item">
                        <div class="list-item-title">
                            üåê ${destination}
                            <span class="badge ${badgeClass}">${type}</span>
                        </div>
                        <div class="list-item-meta">
                            Interface: <strong>${interfaceName}</strong>
                            ${gateway !== 'N/A' ? ` | Gateway: <strong>${gateway}</strong>` : ''}
                        </div>
                    </div>
                `;
            }).join('');
        }

        async function loadAdapters() {
            try {
                const response = await fetch(`${API_BASE}/api/network/info`);
                const data = await response.json();
                
                if (data.success && data.interfaces) {
                    const wifiInterfaces = Object.entries(data.interfaces).filter(([name, info]) => 
                        name.startsWith('wlan') || name.startsWith('wlx')
                    );
                    
                    document.getElementById('adaptersCount').textContent = wifiInterfaces.length;
                    
                    const adaptersList = document.getElementById('adaptersList');
                    
                    if (wifiInterfaces.length === 0) {
                        adaptersList.innerHTML = '<div class="list-empty">Aucun adapter WiFi d√©tect√©</div>';
                        return;
                    }
                    
                    adaptersList.innerHTML = wifiInterfaces.map(([name, info]) => {
                        let ip = 'N/A';
                        let status = 'down';
                        
                        if (info.addresses && info.addresses.length > 0) {
                            const ipv4 = info.addresses.find(addr => addr.type === 'ipv4');
                            if (ipv4 && ipv4.ip) ip = ipv4.ip;
                        } else if (info.ip) {
                            ip = info.ip;
                        }
                        
                        if (info.status) status = info.status;
                        
                        const statusBadge = status === 'up' ? 'badge-success' : 'badge-danger';
                        
                        return `
                            <div class="adapter-card">
                                <div class="adapter-header">
                                    <span class="adapter-name">${name}</span>
                                    <span class="badge ${statusBadge}">${status.toUpperCase()}</span>
                                </div>
                                <div class="adapter-info">IP: ${ip}</div>
                                <div class="adapter-info">Netmask: ${info.netmask || 'N/A'}</div>
                                <div style="margin-top: 12px;">
                                    <button class="btn btn-secondary" style="padding: 6px 12px; font-size: 12px; margin-right: 8px;" onclick="toggleMonitorMode('${name}')">
                                        üéØ Monitor
                                    </button>
                                    <button class="btn btn-secondary" style="padding: 6px 12px; font-size: 12px;" onclick="toggleInterface('${name}')">
                                        ${status === 'up' ? '‚èπÔ∏è Down' : '‚ñ∂Ô∏è Up'}
                                    </button>
                                </div>
                            </div>
                        `;
                    }).join('');
                }
            } catch (error) {
                addToTerminal(`Erreur chargement adapters: ${error.message}`, 'error');
            }
        }

        async function loadAPClients() {
            // Simuler pour le moment - √† impl√©menter c√¥t√© backend
            const clientsList = document.getElementById('clientsList');
            clientsList.innerHTML = '<div class="list-empty">Aucun client connect√©</div>';
            document.getElementById('clientsCount').textContent = '0';
        }

        async function refreshRoutes() {
            try {
                addToTerminal('Actualisation des routes...', 'info');
                const response = await fetch(`${API_BASE}/api/routes`);
                const data = await response.json();
                
                if (data.success) {
                    updateRoutes(data.routes);
                    showToast('Routes actualis√©es');
                    addToTerminal(`‚úì ${data.routes ? data.routes.length : 0} route(s) r√©cup√©r√©e(s)`, 'success');
                } else {
                    addToTerminal('‚úó Erreur lors de la r√©cup√©ration des routes', 'error');
                }
            } catch (error) {
                addToTerminal(`Erreur: ${error.message}`, 'error');
            }
        }

        async function refreshAdapters() {
            addToTerminal('Actualisation des adapters WiFi...', 'info');
            await loadAdapters();
            showToast('Adapters actualis√©s');
        }

        // Ligolo Controls
        async function startLigolo() {
            try {
                addToTerminal('D√©marrage Ligolo...', 'info');
                const response = await fetch(`${API_BASE}/api/services/start`, { 
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({services: ['ligolo-agent']})
                });
                const data = await response.json();
                if (data.success) {
                    addToTerminal('‚úì Ligolo d√©marr√©', 'success');
                    showToast('Ligolo d√©marr√©');
                    setTimeout(loadSystemStatus, 2000);
                }
            } catch (error) {
                addToTerminal(`Erreur: ${error.message}`, 'error');
            }
        }

        async function stopLigolo() {
            if (!confirm('Arr√™ter l\'agent Ligolo ?')) return;
            try {
                addToTerminal('Arr√™t Ligolo...', 'warning');
                const response = await fetch(`${API_BASE}/api/services/stop`, { 
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({services: ['ligolo-agent']})
                });
                const data = await response.json();
                if (data.success) {
                    addToTerminal('‚úì Ligolo arr√™t√©', 'warning');
                    showToast('Ligolo arr√™t√©', 'warning');
                    setTimeout(loadSystemStatus, 2000);
                }
            } catch (error) {
                addToTerminal(`Erreur: ${error.message}`, 'error');
            }
        }

        async function restartLigolo() {
            try {
                addToTerminal('Red√©marrage Ligolo...', 'info');
                const response = await fetch(`${API_BASE}/api/ligolo/restart`, { method: 'POST' });
                const data = await response.json();
                if (data.success) {
                    addToTerminal('‚úì Ligolo red√©marr√©', 'success');
                    showToast('Ligolo red√©marr√©');
                    setTimeout(loadSystemStatus, 2000);
                }
            } catch (error) {
                addToTerminal(`Erreur: ${error.message}`, 'error');
            }
        }

        // WiFi AP Controls
        async function startAP() {
            try {
                addToTerminal('D√©marrage Access Point...', 'info');
                const response = await fetch(`${API_BASE}/api/services/start`, { 
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({services: ['hostapd', 'dnsmasq']})
                });
                const data = await response.json();
                if (data.success) {
                    addToTerminal('‚úì Access Point d√©marr√©', 'success');
                    showToast('Access Point d√©marr√©');
                    setTimeout(loadSystemStatus, 2000);
                }
            } catch (error) {
                addToTerminal(`Erreur: ${error.message}`, 'error');
            }
        }

        async function stopAP() {
            if (!confirm('Arr√™ter l\'Access Point ?')) return;
            try {
                addToTerminal('Arr√™t Access Point...', 'warning');
                const response = await fetch(`${API_BASE}/api/services/stop`, { 
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({services: ['hostapd', 'dnsmasq']})
                });
                const data = await response.json();
                if (data.success) {
                    addToTerminal('‚úì Access Point arr√™t√©', 'warning');
                    showToast('Access Point arr√™t√©', 'warning');
                    setTimeout(loadSystemStatus, 2000);
                }
            } catch (error) {
                addToTerminal(`Erreur: ${error.message}`, 'error');
            }
        }

        async function restartAP() {
            try {
                addToTerminal('Red√©marrage Access Point...', 'info');
                const response = await fetch(`${API_BASE}/api/services/restart`, { 
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({services: ['hostapd', 'dnsmasq']})
                });
                const data = await response.json();
                if (data.success) {
                    addToTerminal('‚úì Access Point red√©marr√©', 'success');
                    showToast('Access Point red√©marr√©');
                    setTimeout(loadSystemStatus, 3000);
                }
            } catch (error) {
                addToTerminal(`Erreur: ${error.message}`, 'error');
            }
        }

        // Pentest Adapter Controls
        async function toggleMonitorMode(interfaceName) {
            addToTerminal(`Mode monitor pour ${interfaceName} - Fonctionnalit√© √† impl√©menter`, 'warning');
            showToast('Fonctionnalit√© en d√©veloppement', 'warning');
        }

        async function toggleInterface(interfaceName) {
            addToTerminal(`Toggle interface ${interfaceName} - Fonctionnalit√© √† impl√©menter`, 'warning');
            showToast('Fonctionnalit√© en d√©veloppement', 'warning');
        }

        async function scanNetworks() {
            addToTerminal('Scan des r√©seaux WiFi - Fonctionnalit√© √† impl√©menter', 'warning');
            showToast('Fonctionnalit√© en d√©veloppement', 'warning');
        }

        // Utility functions
        async function showLogs() {
            try {
                const response = await fetch(`${API_BASE}/api/logs`);
                const data = await response.json();
                if (data.success && data.logs) {
                    addToTerminal('=== LOGS SYST√àME ===', 'info');
                    const logs = Array.isArray(data.logs) ? data.logs : data.logs.ligolo || [];
                    const recentLogs = logs.slice(-20);
                    if (recentLogs.length === 0) {
                        addToTerminal('Aucun log disponible', 'warning');
                    } else {
                        recentLogs.forEach(log => {
                            if (typeof log === 'object' && log.line) {
                                addToTerminal(log.line, 'info');
                            } else if (typeof log === 'string') {
                                addToTerminal(log, 'info');
                            }
                        });
                    }
                    addToTerminal('=== FIN LOGS ===', 'info');
                } else {
                    addToTerminal('Aucun log disponible', 'warning');
                }
            } catch (error) {
                addToTerminal(`Erreur: ${error.message}`, 'error');
            }
        }

        async function showNetworkInfo() {
            try {
                const response = await fetch(`${API_BASE}/api/network/info`);
                const data = await response.json();
                if (data.success && data.interfaces) {
                    addToTerminal('=== INFORMATIONS R√âSEAU ===', 'info');
                    Object.entries(data.interfaces).forEach(([iface, info]) => {
                        let ip = 'N/A';
                        let status = 'unknown';
                        
                        if (info.addresses && info.addresses.length > 0) {
                            const ipv4 = info.addresses.find(addr => addr.type === 'ipv4');
                            if (ipv4 && ipv4.ip) ip = ipv4.ip;
                        } else if (info.ip) {
                            ip = info.ip;
                        }
                        
                        if (info.status) status = info.status;
                        
                        addToTerminal(`${iface}: ${ip} (${status})`, 'info');
                    });
                    addToTerminal('=== FIN INFO R√âSEAU ===', 'info');
                } else {
                    addToTerminal('Informations r√©seau non disponibles', 'warning');
                }
            } catch (error) {
                addToTerminal(`Erreur: ${error.message}`, 'error');
            }
        }

        async function exportConfig() {
            try {
                const response = await fetch(`${API_BASE}/api/config/export`);
                const data = await response.json();
                if (data.success && data.config) {
                    const blob = new Blob([JSON.stringify(data.config, null, 2)], { type: 'application/json' });
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `rasppunzel-config-${new Date().toISOString().split('T')[0]}.json`;
                    a.click();
                    URL.revokeObjectURL(url);
                    addToTerminal('‚úì Configuration export√©e', 'success');
                    showToast('Configuration export√©e');
                } else {
                    addToTerminal('‚úó Erreur', 'error');
                }
            } catch (error) {
                addToTerminal(`Erreur: ${error.message}`, 'error');
            }
        }

        // Initialisation
        document.addEventListener('DOMContentLoaded', () => {
            initializeSocket();
            setInterval(loadSystemStatus, 30000);
        });

        // Raccourcis clavier
        document.addEventListener('keydown', (e) => {
            if (e.ctrlKey && e.key === 'l') {
                e.preventDefault();
                clearTerminal();
            }
            if (e.ctrlKey && e.key === 'r') {
                e.preventDefault();
                loadSystemStatus();
            }
        });
    </script>
</body>
</html>